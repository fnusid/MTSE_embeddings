LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name   | Type                 | Params | Mode
--------------------------------------------------------
0 | model  | RecursiveAttnPooling | 6.6 M  | train
1 | loss   | LossWrapper          | 0      | train
2 | metric | MetricsWrapper       | 0      | train
--------------------------------------------------------
6.6 M     Trainable params
0         Non-trainable params
6.6 M     Total params
26.599    Total estimated model params size (MB)
117       Modules in train mode
0         Modules in eval mode
Sanity Checking DataLoader 0:   0%|                                                                                                                                                                                                                                             | 0/2 [00:00<?, ?it/s]> /gpfs/accounts/profdj_root/profdj0/sidcs/codebase/speaker_embedding_codebase/recursive_attn_pooling.py(101)forward()
/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:433: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=19` in the `DataLoader` to improve performance.
/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/torchaudio/_backend/utils.py:213: UserWarning: In 2.9, this function's implementation will be changed to use torchaudio.load_with_torchcodec` under the hood. Some parameters like ``normalize``, ``format``, ``buffer_size``, and ``backend`` will be ignored. We recommend that you port your code to rely directly on TorchCodec's decoder instead: https://docs.pytorch.org/torchcodec/stable/generated/torchcodec.decoders.AudioDecoder.html#torchcodec.decoders.AudioDecoder.
  warnings.warn(
/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/torchaudio/_backend/ffmpeg.py:88: UserWarning: torio.io._streaming_media_decoder.StreamingMediaDecoder has been deprecated. This deprecation is part of a large refactoring effort to transition TorchAudio into a maintenance phase. The decoding and encoding capabilities of PyTorch for both audio and video are being consolidated into TorchCodec. Please see https://github.com/pytorch/audio/issues/3902 for more information. It will be removed from the 2.9 release.
  s = torchaudio.io.StreamReader(src, format, None, buffer_size)
-> h = self.encoder(x, aug=False)  # [B, D, T]
*** No help for '= self.encoder(x.mean(dim=1), aug=False)'
tensor([[[9.3081e-01, 4.3428e+00, 9.8708e-01,  ..., 1.0673e+00,
          9.9610e-01, 3.7006e+00],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          8.6433e-01, 5.4176e-01],
         [2.2571e+00, 3.2369e+00, 3.5577e+00,  ..., 3.4830e+00,
          4.1748e+00, 6.1734e+00],
         ...,
         [3.7486e+00, 3.0939e+00, 2.4561e+00,  ..., 2.4650e+00,
          1.8005e+00, 0.0000e+00],
         [0.0000e+00, 0.0000e+00, 1.2114e+00,  ..., 9.4795e-01,
          5.0397e-01, 5.9951e-01],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[0.0000e+00, 7.5046e-01, 0.0000e+00,  ..., 8.4556e-01,
          5.7610e-01, 1.5690e+00],
         [5.2483e-02, 1.1303e+00, 7.4895e-01,  ..., 0.0000e+00,
          3.0794e-02, 0.0000e+00],
         [4.0004e-01, 7.4255e-01, 1.1971e+00,  ..., 2.1563e+00,
          2.7333e+00, 3.8709e+00],
         ...,
         [2.8645e-01, 7.1175e-01, 6.3200e-01,  ..., 8.4118e-01,
          5.6983e-01, 0.0000e+00],
         [1.7100e-01, 0.0000e+00, 0.0000e+00,  ..., 1.1650e+00,
          6.7533e-01, 1.0117e+00],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[2.5001e-01, 1.4055e+00, 3.5695e-01,  ..., 3.8337e-01,
          3.4503e-01, 1.2090e+00],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          2.3321e-01, 1.1920e-01],
         [7.8046e-01, 1.1227e+00, 1.1516e+00,  ..., 1.1326e+00,
          1.3356e+00, 1.9463e+00],
         ...,
         [1.2425e+00, 1.0318e+00, 7.6484e-01,  ..., 7.6877e-01,
          6.8939e-01, 4.4358e-02],
         [0.0000e+00, 0.0000e+00, 3.8570e-01,  ..., 3.0783e-01,
          1.0826e-01, 2.6521e-01],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        ...,

        [[2.0417e-01, 3.0288e+00, 8.3412e-01,  ..., 3.6746e-03,
          0.0000e+00, 0.0000e+00],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [2.0111e+00, 2.6298e+00, 3.5628e+00,  ..., 3.3974e-01,
          0.0000e+00, 0.0000e+00],
         ...,
         [2.4169e+00, 2.2828e+00, 1.1992e+00,  ..., 1.5588e+00,
          2.3641e-01, 0.0000e+00],
         [9.8456e-02, 0.0000e+00, 9.0267e-01,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 9.9379e-02,
          7.4827e-01, 0.0000e+00]],

        [[8.6195e-01, 3.8819e+00, 9.0496e-01,  ..., 9.7803e-01,
          9.1000e-01, 3.2536e+00],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          8.4387e-01, 3.3245e-01],
         [2.0701e+00, 2.9410e+00, 2.9486e+00,  ..., 2.8785e+00,
          3.3978e+00, 5.1114e+00],
         ...,
         [3.1597e+00, 2.5940e+00, 1.8824e+00,  ..., 1.8924e+00,
          1.4147e+00, 0.0000e+00],
         [0.0000e+00, 0.0000e+00, 1.0830e+00,  ..., 8.6274e-01,
          3.5025e-01, 5.6055e-01],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]],

        [[5.5066e-01, 2.8527e+00, 8.4888e-01,  ..., 9.1008e-01,
          7.3557e-01, 2.1865e+00],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          1.7771e-01, 0.0000e+00],
         [1.1995e+00, 1.7812e+00, 1.8619e+00,  ..., 1.8064e+00,
          2.2901e+00, 3.5251e+00],
         ...,
         [2.2813e+00, 1.8535e+00, 1.3482e+00,  ..., 1.3493e+00,
          9.0272e-01, 0.0000e+00],
         [0.0000e+00, 0.0000e+00, 9.1863e-01,  ..., 7.5390e-01,
          4.4686e-01, 5.8566e-01],
         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,
          0.0000e+00, 0.0000e+00]]], device='cuda:0')
Traceback (most recent call last):
  File "/gpfs/accounts/profdj_root/profdj0/sidcs/codebase/speaker_embedding_codebase/trainer.py", line 87, in <module>
    trainer.fit(model, dm)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 560, in fit
    call._call_and_handle_interrupt(
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 598, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1011, in _run
    results = self._run_stage()
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1053, in _run_stage
    self._run_sanity_check()
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1082, in _run_sanity_check
    val_loop.run()
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 145, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 437, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 412, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "/gpfs/accounts/profdj_root/profdj0/sidcs/codebase/speaker_embedding_codebase/trainer.py", line 46, in validation_step
    emb, p = self(noisy)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/gpfs/accounts/profdj_root/profdj0/sidcs/codebase/speaker_embedding_codebase/trainer.py", line 31, in forward
    emb, p = self.model(x)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/gpfs/accounts/profdj_root/profdj0/sidcs/codebase/speaker_embedding_codebase/recursive_attn_pooling.py", line 101, in forward
    h = self.encoder(x, aug=False)  # [B, D, T]
  File "/gpfs/accounts/profdj_root/profdj0/sidcs/codebase/speaker_embedding_codebase/recursive_attn_pooling.py", line 101, in forward
    h = self.encoder(x, aug=False)  # [B, D, T]
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/scratch/profdj_root/profdj0/sidcs/envs/miniconda3/envs/mtse/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
